The studied region (Pays de Caux, near Rouen, fig.1) has been subject for some years to severe run-off and soil erosion processes, mainly after violent spring rain-storms, or long winter rains (BOIFFIN & al. 1988, PAPY & DOUYER 1991, DELAHAYE & al. 1999). The repercussions of these events are all the more important as the whole area is characterised by a strong suburban growth. The situations are very similar  : the floods are developing in small rural basins deprived of permanent flows. The fossil network of dry stream channels, inherited from the periglacial periods, may be again operative after long or very intense rains (AUZET & al. 1993).

Fig. 1 location of the studied area
In the evening of June 16th 1997, after a rain-storm of about 30 inches within 6 hours, four small drainage basins were affected by floods and it became obvious that no simulation tools of the spatial dynamics of these floods were available. The basin of Villers-Ecalles (5.5 square miles) has been taken as an illustration, for the different types of situations are represented there. A turbid flow developed upstream, and by successive concentration got ahead to the main thalweg.(fig 2) In some places, the secondary channels went on supplying an additional out-flow. The soil erosion in the parcels has been important and a lot of houses were flooded. The damage was highest at the junction of the secondary thalwegs, where the flow was concentrated.

Fig. 2. Land-use and flow (Villers-Ecalles, june 16 th 1997)
There is of course a relation between the size of the sub-basins and the total discharge, but this relation is affected by the land use. The upstream and medium areas of the larger sub-basins with gentle slopes on the plateau are occupied by cultivated surfaces and small hamlets. In June the soil is covered with wheat and barley, also corn, potatoes, flax, rape and beet. Downstream, and in the small sub-basins, the periglacial valley slopes with a high declivity, exposed to the south, are exclusively covered with woods. The other slopes are mainly grassland.
The corn (maize) areas are the more exposed to the run-off process and soil erosion (DELAHAYE, 1996), for this spring cultivation does not cover the soil, which remains, in June, rather light and easily carried away. Nevertheless the sub-basins are seldom covered evenly by the same plant. The result is the development of chain reactions on the slopes with a water circulation from one parcel to another. The analysis is made more complex by these transfers.
Studying exceptional events provides a good illustration of the spatial evolution of the run-off and flood processes. The upstream areas, sometimes very far from the flooded regions, submit the downstream communities to risks. The spatial analysis approach evidences these spatial links and the scale transfers from the parcel to the drainage basin (FAURE SOULET & al. 1994). This dynamic approach is essential to study the sensibility of the different spaces and to promote coherent planning schemes, but the modelling tools are still to explore.
The management of the flood hazard, on the contrary, is too often fragmented, as a result of the divisions of the administrative areas. On the one hand, the maintenance of important dams downslope to reduce the effects of flooding is expensive ; and, on the other hand, the local measures taken by the different local authorities upstream have as a main purpose to evacuate the water as quickly as possible to the neighbourhood. It is this lack of spatial solidarity that generates the main problems.
This fragmented approach is also obvious in the definition of the responsive surfaces for the mapping of risks (KING & al. 1992). These surfaces are defined, notably in a GIS view, by a mere overlay of data about the nature of soil, the slope angle and the type of land use (LARDON, 1992). The deficiency of this approach lies in the fact that the location of each surface in the basin is essential to explain its behaviour after a rain-storm. Besides the internal factors, the relations with the spatial environment must be taken into account for each zone, in order to estimate its reaction to the overland flow and its outcome downslope (GARY 1993).
The cartography of the global dynamics of a drainage basin needs new modelling tools allowing the connection of the different local processes.
The diversity of the topography and the variety of the mechanisms involved precludes a global modelling of the run-off process and requires a sharp division of the concerned area into homogeneous and interconnected cells. The cellular automata model answers the question, but needs to be generalised to incorporate the variety of the topographical conditions : elementary surfaces on hillslopes, linear portions of thalwegs, and local depressions. Besides their physical measures, the spatial dimensions of the cells may be 0, 1 or 2 (point, line or surface). Moreover the connections of the automata must not be directed only by the neighbourhood topology of the cells, but also by the morphological links organising the space : links of discharge between the cells, links of overflow between the sub-basins. The first purpose of the automaton will be to define an index of risk, by a surface propagation, at every place in a drainage basin, and to map out this index.
We have used a DTM according to square grid cells of 75 meters length. Two techniques are available to shape the surface : a "storied" function, obtained by the calculation of the differences between neighbouring cells (LAURENT & al.1998), or the meshing in finite elements, which gives a continuous interpolation between the points of the DTM. We have chosen the latter, which gives for each pointP(x, y) its elevation zP, its vector normal to the surface, allowing the calculation of every measure of size related with the local shape of the terrain (slope angle, exposition, run-off vector, and then surfaces, volumes, flow, etc.).
The square cells are convenient for our data, but they forbid an interpolation by a plane, so we have divided each square cell into two triangles, choosing one of the diagonals (fig.3).

Fig. 3 Square network or triangular network
This choice is not indifferent, for the diagonals do not cross at the same height. To favour the outflow, the chosen diagonal is the one having no risk of obstructing a stream channel, that is the one with the minimum height at the crossing point.
The common structure for all the data sets will therefore be a triangulated irregular network (TIN), also called a Delaunay triangulation. Because of its linear applications, this offers the simplest finite elements model, which is a substantial gain if we want to operate on a PC with a very large amount of cells.
In order to optimise the access to geometric information, a topological graph has been applied to the TIN structure ; it is composed of three main features  : pole, arc, triangle, inducing the following relational tables :
Poles(IdPole, x, y, z)
Arcs(IdArc, PoleInitial, PoleFinal, TrgAGauche, TrgADroite, ArcSuivAGauche, ArcPrecADroite)
Triangles(IdTrg, PremierArc )
The arcs play a major role  : each arc being connected to two poles and two triangles, a morphological attribute may be given to it by the relative heights of the former and the relative slope angles of the latter. Through comparing the heights of the two poles, we can see if the arc is downhill, uphill, or flat. As for the triangles, two of them side by side may be also, individually, downhill, uphill or flat. So an arc whose final pole is lower than the initial one is downhill, and if its two neighbouring triangles are also downhill towards it, it is a downhill thalweg. The theoretical typology gives 33 = 27 possibilities. After eliminating some situations, we have kept only the following attributes for the arcs :
TMorphoArc = ( Crete, PenteAGauche, PenteADroite, TalwegMontant, TalwegDescendant, RebordGauche, RebordDroit, FondGauche, FondDroit, Plat, LimiteExterne) ;
The type "external limit" has been introduced to handle with the limits of the studied area. The type "flat" is attributed to the limit between two flat triangles. It must be stressed that these attributes are purely local  : if an arc is a "dowhill thalweg" there may be no continuity for the downstream arcs. Yet its knowledge is important to determine the run-off process, which is linear along this arc, whereas, if the attribute of the arc is " left slope", the run-off is a sheet-flow and its direction is transversal to the arc (Fig. 4).

Fig. 4 Local morphology of an arc
It is not easy to feature the global network of the thalwegs, because of the lack of continuity of the local morphology. When the thalweg becomes wider, it is formed by a certain amount of triangles in which there is a sheet-flow transversal to the arcs. The local attributes of the arcs are no longer sufficient to shape the network. All the links between the elements (poles, arcs, triangles) of the topological graph must be taken into account. The resulting run-off graph is similar to an oriented dual of the topological graph, but is in fact more complex, as the dual graph connects only the triangles, whereas this one connects poles, arcs, and triangles. A drop of water laid on a triangle may flow towards the neighbouring triangle if the connected arc is a "leftslope", but may flow in the arc itself if it is a "downhill thalweg". The drop may flow, afterwards, towards a triangle or towards another arc, or may also be stopped in a pole if the pole is a basin.
A triangle may be connected upstream to three neighbouring triangles at the most, but it may also receive water from one or more thalwegs arriving by one or more of its vertices. It may be connected also downstream to one or two neighbouring triangles. In this latter case, transition factors must be calculated to define, on each side of the line of greater slope angle, the proportion of the flow towards each of the two downstream triangles.
Some disturbing conditions make the situation more complex. The channel streams of the studied area are mostly ephemeral streams using an old periglacial drainage network : the thalwegs have not a continuous declivity, but are made of a sequence of little basins creating a series of discontinuities in the flow. Another problem comes from the DTM, whose 75 meters precision of the grid is unable to take into account the gorges of small dimensions, which actually drain most of the basins. Moreover the precision of one meter for the elevation data produces, in approximately flat areas, a large number of completely horizontal triangles in which the calculation of the vector of greater slope angle is not possible.
The run-off graph must thus be improved by two complements concerning two specific situations : the flat portions and the local basins.
In a flat portion, the algorithm seeks first for the meshes ei which are on the border, thus neighbouring outer meshes ej. The direction of the flow depends on the relative height of ei and ej . All the border meshes being affected with a stream direction, the same algorithm is used for the remaining triangles of the flat portion.
The problem of the local basins leads to a division of the total surface between sub-basins, connected with each other for their overflow. The overflow channel may be a pole or an arc of minimum height on the border of the sub-basin. In the case of a flat triangle the discharge flows towards two neighbouring sub-basins : the watershed is not always a line, but more often a surface formed by triangles belonging to both sub-basins.
Let us call D the set of triangles of the studied area. The upstream-downstream relation (extended to the flat portions and to the links between basins and overflow basins) infers an order on D : let us say that t1 > t2 , (t1 is upstream of t2), when a chain of elements of the graph does exist , from t1 to t2 , with a sequential link by the relation of flow. This is a partial order.
The sub-basins form a family F of parts of D, but this is not a partition, for the sub-basins may overlap on their watershed surface. It is therefore impossible to attribute a figure of sub-basin to each triangle. A basin is a set of triangles with the same overflow channel. A basin contains usually several bowls, and each of them defines a singular sub-basin. If the discharge of the sub-basin C, around the bowl c, flows towards the sub-basin B, around the bowl b, that means that c is upstream. Let us write : c > b and
The overflow between two sub-basins X and Y may be reciprocal. As we are not allowed to write x > y et y > x, with x ≠ y, the suppression of these links of reciprocal outflow is needed and a single basin must be created (Fig. 5). To close the relation an exterior basin is defined.

Fig. 5 Insertion structure of basins B and C in basin A
The cells of the automaton are the elements of the topological graph : triangles, arcs and poles. The links between the cells have been defined by the run-off graph. The first stage to run the system has been the calculation, for each triangle, of the upstream surface.
Let C= [cij] be the matrix of the outflow coefficients from cell i to cell j. If vi is the value of cell i, the transferred value from cell i to cell j will be wj = vi cij . This value is zero if cij = 0, which means that i and j are not connected. The sum of each row is 1 (transition coefficient) and the sum of each column is the value received by cell j from all the connected upstream cells.

Fig. 6 Simplified automaton to calculate the upstream surface
(vj in the upper case, sj in the lower case of each cell)- see equations (1) and (2) below -
After a starting stage, where a surface is ascribed to the state vi of each triangular cell (the initial values for the arcs and bowls is zero), each iteration is divided between two stages : a communication stage and an evaluation stage of the new state of the cell. In the communication stage, the values wij = cij vi are ascribed to the entry registers (w1j, w2j,…, wnj) of each cell j . In the evaluation stage the entry registers are summed up to obtain the new state of cell j :
(1)
Then the different states of each cell are progressively cumulated :

which gives finally the total of the values vjt of cell j at the different moments t :
(2)
This very simple mechanism (Fig. 6) provides a validation of the automaton and brings to light some problems that had been underestimated at the beginning of the research, such as the run-off interruption in the small bowls, or the flat portions in the thalwegs. These discontinuities are often explained by the imprecision of the DTM. It has been also necessary to take into account the links between the bowls and the overflow basins.
This device has allowed us also to make an evaluation of the calculation time, which has proved satisfactory ( about 20 or 30 seconds for more than 100 000 cells on a PC).
Knowing the upstream surface in each cell, we may calculate run-off indices used in hydrological models, such as TOPMODEL (QUINN 1995), to represent the pattern of the surface elements.
A land use coefficient has been assigned to each parcel, as follows :
Utilisation du sol
Coeff.
Corn
2
maize
3
grass
-2
forest
-3
rape
1
dwellings
2
These coefficients have been transferred from the land use parcels to the triangles of the meshing. The triangles being by far smaller than the parcels, the value taken for one triangle is the value of the parcel in which the gravity centre of the triangle is located.
Each cell (triangle) receives as an initial value the land use coefficient. Then the algebraic sum of the positive states of the upstream cells is worked out. If one cell has a negative state, that means that the algebraic sum of the upstream values with its own coefficient gives a negative result  : there is an absorption and no outflow from that cell (fig.7).

Fig. 7. Map of the run-off and flow integrating land use coefficients
This experiment has led to the construction of spatial indices of sensibility to the run-off process. It could be linked later on with other layers of a GIS and also with a multi-agent system in order to integrate information on agricultural practices, forms of urban development, road network and environmental constraints.
A validation of our approach has been achieved through a simulation of the diffusion of the run-off process in the basin of Villers-Ecalles after a rain of 70 mm. This isolated shower is conform to the pluviometric event recorded on June 16th 1997 on this area.
The run-off map (fig.2) highlights the links between the different contributing compartments and the successive concentrations in the basin. The figure n° 7 allows us to compare this simulation with the observed situation of the violent storm of June 97. The automate answers to the starting objectives, due to a very efficient delimitation of the basin area, and an obvious demonstration of the areas most sensitive to the run-off process. The divergence with the observations is important in the upstream southern part of the basin. The simulation, indeed, locates a major flow which has not been observed in this area. The implements having not been integrated in the model, the simulation has not taken into account the influence of the highway crossing the upstream part of the basin. This highway has stopped the flow and produced a levelling of the flood, generating retentions of water along the embankments. The observation shows the limits of the model, but stresses also the efficiency of such a tool, to evaluate the incidence of an implement on the behaviour of a basin. The integration of the implements and of their associated hydraulic constraints (storage, tubes, highways, etc…) is a priority for further developments of the model.
The results show the accuracy of this approach, and how, starting from a rather simple data set, it is possible to set up a cartographic presentation of the run-off dynamics. The inputs of the model remain nevertheless too limited for a shift to an actual estimation of the flows.
The variable "infiltration capacity" is steady along the time, and limited to a reduced number of classes. The monitoring of the diffusion of the water in the cells is done by an iterative device which is very far from the actual conditions of flow. This monitoring of the run-off process in real time implies the introduction of the speeds of the flows, and this parameter is not easily perceived in the lack of in-situ measurements. The interpretation is therefore limited to the cumulativeness of the amounts of water flowing through each cell. These cumulative amounts, mainly at the outlet, are not far from the estimations of the hydraulic and hydrologic models made by diverse research consultants at the time of the appraisal which followed the disaster. We have to remain careful about these evaluations, for their validation would need that the automate could be tested on numerous basins. Our aim being mainly to give a spatial presentation of the flows, we shall limit our comments to this aspect.
The mudslides and the catastrophic floods are not unusual in Upper Normandy, and a further development of knowledge is relevant to develop indicators of risk for the prevention of such events. The evidence of the role of morphology and land use have been clearly showed in the development of these hydrologic crises. In order to work toward a modelisation of these phenomena, the necessity became obvious to take into account the keen structure of the ground surface, in its shape (topography, altitudes, slopes, etc…) as well as in its morphologic organisation. This needs a general model of cellular automata, composed of areal, linear and pin-point cells, with varied shapes.
The model fulfils the determined aims. The delimitation of the basins is quite suitable, as well as the interpretation of the hydraulic connexions in the basin, and the hierarchy in each point of the space in the areas affected by the run-off.
