Since a few decades, towns of industrialised countries grow by their outskirts. The spread of the individual automobile within the whole society explains much of this trend, which has major spatial impacts. This diffused and often spontaneous urbanisation, based on individual strategies, leads to social dilemmas, including mobility related ones. As Torrens and Alberti, state : "it could be argued that sprawl violates just about every premise of sustainability that a city could be judged by" [Torrens and Alberti, 2000, pp. 1].
Moreover, national peculiarities may be added to these trends : if travel needs still increase, in France, a qualitative turn seems to be reached. Indeed, the rate of daily journeys to work decreases, while the rate of leisure trips augments. This development has to be connected with the changing way of life, and will probably be amplified by the decrease of working time. A direct consequence of this evolution is that polarised flows towards towns and town centres are not as much representative as before of the spatial pattern of daily flows, as fringe flows take more and more importance.
Public transport has to manage these trends, and must evolve to fulfil its mission. It cannot remain on its traditional target, that is daily journeys to work during rush hours, within densely populated areas of towns. Nevertheless, the will to compete with the individual automobile, what is more on its own territories, implies to take up many challenges. In our opinion, versatile solutions can greatly contribute to pick up the gauntlet. This quest for versatility in public transport services is closely related to a major marketing shift, based on the henceforth well known pair of market segmentation and product differentiation.
Market segmentation describes the division of a market into homogeneous groups which will respond differently to promotions, communications, advertising and other marketing mix variables. Each group, or "segment", can be targeted by a different marketing mix because the segments are created to minimise inherent differences between respondents within each segment and maximise differences between each segment. Once a "niche marketing" is identified, any personalised solution can be consequently imaged and tested, leading to a better use of the service proposed.
However, if market research survey techniques, such as conjoint analysis, already exist, it is our opinion that versatile ways of analysing the results from this kind of survey are still to be imagined. In particular, the main problem of the spatial generalisation of this individual information remains often unsolved. The aim of this article is to present an example of a practical strategy set up in a context of operational research, that led to the creation of a personalised public transport service. First, the survey strategy retained will be presented. Then, a procedure dedicated to the production of market maps, through spatial generalisation, will be exposed.
It is now common practice to obtain information about people’s mobility behaviours using dedicated surveys. Nevertheless, since the sixties, the point of view favoured changed much [Hartgen, 1992]. Stated preferences surveys, which come from investigations led in the early seventies in the market research field [Green and al., 1971, 1973, 1978], are considered nowadays as one of the most important progresses in the field of transportation research. Anyway, the early adaptations of Davidson [1973] and Louviere and his colleagues [1975] to this field had a weak impact at that time. The dominant paradigm of discrete choice modelling, mostly based on revealed preferences data, was then firmly anchored. Major textbooks of the time rarely mentioned these major innovations [Domencich and Mc Fadden,1975 ; Ben-Akiva and Lerman, 1985 ; Kanafani, 1983 ; Meyer and Miller, 1984 ; Manheim, 1979], and Kanafani’s point of view is very informative from this point : "urban transportation models are usually based on hypothesis concerning the behaviour of urban travellers, which are empirically validated by observing trip behaviour. In other words, it is not possible to conduct "controlled" experiments or laboratory tests to ascertain how travellers would behave under hypothetical situations. Consequently, demand models are constructed on the basis off observations of traveller behaviour under existing transportation supply conditions" [Kanafani, 1983, pp. 88].
Stated preferences surveys were used quite often in transportation planning during the eighties, but were definitely accepted by the tenors of econometric modelling during the nineties [Morikawa, 1989 ; Ben-Akiva and Morikawa, 1990 ; Ben-Akiva and al., 1992 ; McFadden 2000]. Two reports [Spear, 1996 ; TMIP, 1994] suggest that efforts are still to be pursued to give these methods the place they deserve.
Introducing briefly revealed and stated preferences methods, sometimes seen as concurrent rather than complementary approaches [Herridges and al., 1999], will allow us to present what we have called "caused preferences" [Banos and Josselin, 2000].
The so-called revealed preferences approach, based on an as much as direct apprehension of observable and realised mobility behaviours, has been privileged by economists for a long time [Hensher, 1994]. Nevertheless, three main criticisms can be addressed to this seeming "objective" approach. First, mobility behaviours highlighted this way are by definition limited to the conditions observed during the survey, and can hardly be extrapolated to conditions beyond the observations. In other words, revealed preferences tell us little about the modification of mobility behaviours possibly induced by the hypothetical introduction of a new alternative. Then, as the main idea is "…that by studying the chosen alternative relative to all possible (and available) alternatives, we can infer people’s preferences (utility function)" [Bradley and Kroes, 1990, pp. 94], this approach is very data demanding and consuming. Finally, the reputed reliability of data obtained this way, based on the apparent direct apprehension of an objective reality, can be misleading. We can hardly be satisfied with the simple description of a behaviour by its author, given the extreme variability of individual perceptions at work, especially in the spatial and temporal dimensions.
Stated preferences surveys are based on rather different principles. Indeed, people are asked to give their opinion about a conjectural but realistic transport scenario. This kind of survey is thus well adjusted when we need to appreciate the market for a new transport alternative, for which we have no previous experience. The basic idea is incontestably simple, as John Paterson summed it up in a humorous allocution : "This new field derived major insights from a powerful theoretical development which suggests that one way to predict what people will do is to ask them. Such an approach may not seem radical to the psychologist, but those of us reared in the economics tradition take the view that you can’t rely on the average consumer to verbalise his choice behaviour in a way which is consistent with the axiomatic basis of utility maximisation. When it comes to the traveller, the economist doesn’t believe him, and the engineer doesn’t care" [Paterson, 1979, pp. 860].
Obviously, a naive approach would be somewhat suspicious, and precautions have to be taken, if we are to obtain meaningful declarations. Nevertheless, beyond this fact, two more remarks can be formulated. First, stated preferences surveys do not reflect actual travel behaviours. More, the idea is to conceive strategies based not on the way people would behave in a given context, but rather on how they say they would act. Second, during the survey, respondents have to be presented with much more information than they would have in making their travel decisions. This drawback mainly implies that models developed using stated preference data do not reflect the uncertainty travellers experience in reality.
The basis stated preferences surveys rely on – i.e. to obtain declarations in an hypothetical context – are still not fully accepted. Indeed, many bias can occur during stated preference data collection, amongst which we can cite, following [Bradley and Kroes, 1990, pp. 96] :
affirmation bias : the respondent may adjust, consciously or not, his/her responses to what he/she thinks the interviewer expects to hear ;
rationalisation bias : while trying to rationalise his/her current behaviour, the respondent may provide artificial responses, that do not reflect the way he/she actually acts ;
policy response bias : the respondent may try to influence, by his/her responses, decisions or policies which he/she believes will be based on the results ;
unconstrained response bias : responses may be somewhat unrealistic, because the respondent may omit actual constraints he/she experiences in reality.
In addition to these four classical bias, we shall mention a more specific one, we called "alternative formulation bias" : the way the interviewer presents the transport alternative he/she wants to test may obviously affect the responses. There is a strong commercial component here, that cannot be avoided.
The main idea we defend here is that we can hardly adopt a fully neutral approach when dealing with new alternatives. More, it seems that the product concept has to be "sold" to the respondent from the very first contact. The alternative proposed should then be firmly engaged, from a political and commercial point of view. The survey can therefore be seen as a commercial lever, as well as a reliable way of getting precious data. This process, we called "caused preferences surveys", can finally be justified by the following arguments :
during its launching time, the service will be sold to users, and the survey can be used to draw up the list of selling points ;
by adopting a voluntary and engaged attitude, we incite the respondent to be more involved in the survey process.
Of course, revealed and caused preferences have to be combined, as revealed preferences constitute a necessary background to analyse and interpret caused ones. However, obtaining such a complete chain of information is far from being obvious and implies adapted survey strategy.
The spread of high speed trains increased daily trips between distant cities. Railway stations have then become major flow generators, covering schedules seldom served by public transport services (early in the morning and late in the evening). A preliminary survey, led by the local bus operator (Compagnie des Transports de Besançon) in 1998, revealed the existence of a possible "niche marketing". Indeed, based on 275 people, this survey showed that 55 % of the TGV passengers in Besançon come to the station by car (against 21 % by taxi and 24 % by walking). More, amongst these 55 %, 19 % only declare using a free parking, while 48 % declare being dropped by a family member and 20 % by a colleague or friend.
Nevertheless, this kind of travel implies serious peculiar difficulties, closely related to the temporal dimension of the trip :
any public transport solution imagined can be seen as the first link of a rather long and complex trip chain. Accordingly, reliability and punctuality will play a major role, leading to demanding solutions ;
operating early in the morning imposes rather competitive trip times, especially when private vehicle is the main concurrent ;
the best moment and location to attain customers is aboard the train, during the journey. Therefore, a strong co-operation of the train company is needed, as well as a questionnaire adapted to this time and context.
The survey process applied in this research integrates these constraints, while being based on a few simple principles. First, the knowledge of mobility behaviours of a given subset of individuals is essential, but not sufficient, especially when studying the introduction of a new service. Second, to obtain reliable information about respondent’s willingness, a step-by-step progress has to be adopted, to ensure that every one enters in the universe of the virtual service. A visual information is thought to help accelerating this involvement process. Third, the service proposed might be as realistic as possible. More, it has to be adapted to the actual experiences of the respondent. Fourth, revealed and caused preferences may be combined. An ideal situation would be to obtain, for each respondent, a complete chain of information, detailing his/her personal characteristics, as well as his/her mobility behaviour in a given context and his/her reactions to the service proposed.
Once these points were identified, a two-steps approach was imagined. In a first step, revealed preferences were collected to the maximum number of people, using a self-filled questionnaire. Then, the second step concerned a caused preference questionnaire, filled in vis-à-vis with a subset of the respondents. The figure 1 sums up this procedure.

Figure 1 : a multi-steps approach, combining revealed and caused preferences
Two objectives were assigned to the caused preference questionnaire. First, it was seen as an aid to calibrate the upcoming service, mainly regarding parameters such as waiting time, travel time, arrival time and price. Second, it was seen as a mean of obtaining reliable information about respondent’s willingness to use the service. To achieve this goal, visual scenarii were proposed, in a strategy exploiting both "ranking-based" et "rating-based" responses. Three scenarii were proposed, combining three attributes related to the comfort of the trip, its timing and its price (Figure 2).
It may be mentioned that some of the parameters tested (travel time, price and vehicle) were adapted to the location of each individual with regard to the railway station. This adaptive procedure helped us providing a virtual service as realistic as possible.

Figure 2 : the visual scenarii tested
Initially, a sampling strategy was planned, which appeared rapidly unrealistic. Indeed, investigators were allowed to stay only one hour aboard, and a maximum of five days of inquiry was accorded by the SNCF, for a limited number of investigators. Therefore, an "as-much-as-possible" strategy was adopted, leading to convenience samples. The revealed preferences questionnaire was distributed systematically to each traveller, while the caused preferences one was addressed to the maximum number of people during the available time. Four hundred and seventy six self-filled questionnaires were filled and one hundred and twelve interviews were led this way, providing a rich data base. Furthermore, as individuals gave us their personal address when filling the self-filled questionnaire, a very accurate spatial information was constituted.
The qualitative information provided by this survey led to the launching of a demand responsive transport in Besançon, in December 2000, called Evolis (figure 3).

Figure 3 : the motto of Evolis (Compagnie des Transports de Besançon)
As can be seen on figure 1, an exploratory spatial data analysis stage took place between the data collection stage and the launching of the service. It was indeed our belief that we needed very accurate but versatile insights from this rich amount of data. Then, an interactive GIS prototype has been implemented within the statistical programming environment Xlisp-Stat [Tierney, 1990], so as to achieve this goal. Figure 4 provides an overview of this dedicated package.

Figure 4 : interactive analysis using Xlisp-Stat dynamic graphics
Linking maps and graphics in a graphical environment allows to explore spatial data visually, in a very simple way. By dynamically linking several figures, we are indeed able to see how the phenomenon they represent interact, and to lead multidimensional visual exploration of the underlying data set.
Anyway, one of the main problems we are faced to, from this point, concerns our ability to produce market maps on the basis of the results obtained from the survey.
For the strategy exposed, the problem of spatial generalisation can be seen as a nested problem (figure 5)

Figure 5 : two problems in one
The first problem may be expressed as follow : how can we link revealed and caused preferences, so as to predict caused preferences for people for whom we just know revealed ones ? This problem is not only important per se, but also because it leads to an expansion of the dataset’ size, allowing us to handle the second problem : knowing people’s possible preferences, can we forecast where the demand will occur ?
For a few people, that is those for whom caused preferences are known, our chain of information is complete. But this is the case only for a hundred people. And for nearly four hundred of them, individual characteristics and revealed preferences are only known. Then, the question is : can we use our full chain of information to obtain good estimates of the caused preferences of these four hundred people ? Best results are obtained through the procedure shown by figure 6.

Figure 6 : from revealed preferences to caused one
First, caused preferences are simplified, as the exact score people assigned to their preferred alternative does not really help us. Their rough position on the scale of use is sufficient, and two groups can indeed be formed, leading to a binary variable. Then, individual characteristics and revealed preferences are transformed into quantitative variables, using the Disqual procedure [Saporta, 1975, 1997]. Using multiple correspondence analysis, factorial co-ordinates are calculated, leading to a reduction of the initial dataset. Finally, the problem can be seen as a discrimination one : knowing a discriminant function estimated on the first part of the sample, can we use it to assign any other new individual to the group variable of interest ?
Yet, this classical problem is a bit complicated by the existence of non-linearity. The five scatterplot-smoothers [Hastie and Tibshirani, 1990] composing the figure 7 show the relation between the group variable and each factor. This relation is underlined using a Lowess [Cleveland, 1979], enhanced by a bootstrap confidence band [Efron and Tibshirani, 1993].

Figure 7 : addressing the problem of non-linearity
As Buja, Hastie and Tibshirani showed [1994], linear discriminant analysis can be performed by a sequence of linear regressions followed by classification to the closest class centroide in the space of fit. They propose then to replace the linear regression fits by far more flexible non-parametric fits, in the spirit of the generalised additive model [Buja, Hastie and Tibshirani, 1994]. These smooth functions are not defined a priori by the user, as would be the case for example with quadratic discriminant analysis, but during the calibration process, using iterative algorithms. Flexible discriminant analysis was then used here, using the "MDA" code provided by the authors for the R package. Cubic spline functions were used during the calibration process, allowing us to handle the complex relationships showed before.
As a mean of comparison, a generalised logit model was also used, taking the form :

with (X1, …, X5) the five factors obtained from the Multiple Correspondence Analysis and f() cubic spline functions. A benchmarking procedure was then adopted, so as to compare the performance of these various models. As figure 8 show, the computation burden involved by the two non-parametric solutions is worth while, as the classification performance of the procedure is clearly increased.

Figure 8 : comparison of the classification performance of miscellaneous procedures
The error classification rates decrease as the complexity of the models increases, reaching 20 % for the logit one. What we get at the end of this process is an individual probability of belonging to the "good" group (that is group with score above 5), for nearly five hundred people and not only one hundred of them. From this point, the problem of spatial generalisation can then be handled.
Knowing the location of nearly five hundred people, as well as their estimated probability of adopting the service we plan to launch, can we forecast where the demand is more likely to occur in Besançon ? We need more than an estimation of the size of the market for our service : we’d like to know where the demand will occur, as anticipation may allow a much better optimisation of any demand responsive transport. Unfortunately, the information we have is quite poor. Indeed, no information could be obtained from the French National Railway Society, concerning TGV customers in Besançon. What we have instead, at the moment, is distribution of the population in Besançon at the smallest census scale.
Two assumptions, that may be seen very unrealistic, have to be formulated, if we want to carry on :
each person living in Besançon has the same probability of taking the TGV a given day ;
taking the TGV, each person has access to the same information concerning the existence of the service.
Using the information we have, a very simple model can be built, based on an "average customer" [Ben Akiva and Lerman, 1984]. The number of people that could possibly take the service while going to the TGV station, for a given period and a given census unit, can indeed be estimated by the population of this unit multiplied by an average probability of adopting the service :

But we may also want to use the spatial component of our point pattern, estimating a mean probability for each unit based on the local information available in the neighbourhood of this unit k. This can be achieved using a weighted mean for example :

with a distance decreasing function defined as :

More, as the density of points is far from being regular, we may want to adapt locally the size of each neighbourhood to the density of events (figure 9).

Figure 9 : a spatial generalisation procedure based on adaptive neighbourhoods
This goal can be achieved introducing a kernel density algorithm in the model [Silverman, 1986, Bithell, 1990 ; Brunsdon, 1991, Bailey and Gatrell, 1995, Banos, 2001a, 2001b]. The point pattern is first screened with a mobile window of a fixed size, calculating a mean density of events. Then, each neighbourhood in the model is adjusted compared to this value, providing adaptive neighbourhoods. The size of each mobile window depends then on three parameters :
,
with the initial radius of the window centred of unit k, the initial density of events in the neighbourhood of unit k, and an estimation of the mean density across the whole area. Therefore, the radius of each window is adapted automatically to the local density of events using a "balloon estimator" [Sain, 1994] :

where  is a scale parameter fixed to 0.5 by default, is the geometric mean of the K densities obtained using a fixed radius and is the density of events in the neighbourhood of each unit k, estimated by :
.
Here,  is the Euclidean distance between individual i and the centre of unit k and is a bi-square decreasing function defined by :

This process is equivalent, in some ways, to using not the initial point pattern but a probability surface obtained using adaptive smoothing windows. Of course, this basic model can be desegregated according to the available census data, using indicators such as age, sex or profession. Nevertheless, such an improvement would imply a more consistent sample.
From this point, a main question concerns the exploitation of the probability surface estimated. In our opinion, a simulation procedure has to be imagined, to try to reproduce – in its spatial and temporal dimensions – the emergence of demand for the public transport service proposed. For the moment, the solutions implemented, based on very simple statistical principles, lead to very poor results. It is our belief that by integrating adoption and diffusion rules, in the spirit of the early work of Hägerstrand [1963], some improvements could be reached.
Until now, road public transport hardly manages to follow the evolution of mobility behaviours. Indeed, it sometimes seems quite unreal to propose collective solutions to individual behaviours, due to their complexity and diversity. Nevertheless, the viability of such an individual public service implies an accurate knowledge of travel behaviours in a given area, for a given target population, and their connection with the underlying spatial patterns. Geomarketing based surveys, combining revealed and modified stated preferences, called "caused preferences", are a powerful way of acquiring such an accurate information. From a qualitative point of view, this kind of information allows to calibrate public transport services adapted as much as possible to the targeted customers. However, the major problem of the spatial generalisation of this individual information remains often unsolved. In this context, a strategy was proposed, based on the combination of miscellaneous methods. First, a versatile adaptation of the much classical discrete choice modelling approach was proposed, based on the adaptive strategy of generalised additive modelling. A generalised logit model led particularly to accurate results, when trying to predict caused preferences of individuals, given their revealed preferences. A spatial generalisation procedure based on adaptive neighbourhoods was finally proposed, so as to produce market map from individual probabilities of adopting a given service.
